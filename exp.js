function drawDiagram(e=-1){ctx.clearRect(0,0,canvas.width,canvas.height),circles.length=0,ctx.fillStyle="black",ctx.font="700 18px Microsoft Yahei",ctx.textAlign="center",ctx.fillText("\u4f60\u83b7\u5f97",50,135),ctx.fillText("\u4ed6\u4eba\u83b7\u5f97",50,270),sov_list.forEach((t,n)=>{const i=n===clickedNodeIndex,s=n===e?1.2:1,o=rectWidth*s,a=rectHeight*s,l=circleRadius*s,c=circleDistance*s,d=xStart+n*spacing+rectWidth/2,r=yTopRect+rectHeight+circleDistance,u=d-o/2,h=d-o/2,m=r-l-c-a,p=r+l+c,y=i?clickedRectColor:defaultRectColor,f=i?clickedLineColor:defaultLineColor;if(ctx.fillStyle=y,ctx.fillRect(u,m,o,a),ctx.fillStyle="white",ctx.font="18px Arial",ctx.textAlign="center",ctx.fillText(t.youReceive,u+o/2,m+a/2+6),ctx.strokeStyle=f,ctx.lineWidth=2,ctx.beginPath(),ctx.moveTo(d,m+a),ctx.lineTo(d,r-l),ctx.stroke(),circles.push({x:d,y:r,r:l,index:n+1}),ctx.beginPath(),ctx.moveTo(d,r+l),ctx.lineTo(d,p),ctx.stroke(),ctx.fillStyle=y,ctx.fillRect(h,p,o,a),ctx.fillStyle="white",ctx.fillText(t.otherReceives,h+o/2,p+a/2+6),n>0){const e=xStart+(n-1)*spacing+rectWidth/2;ctx.strokeStyle="#4682B4",ctx.beginPath(),ctx.moveTo(e,r),ctx.lineTo(d,r),ctx.stroke()}}),circles.forEach((e,t)=>{const n=t===clickedNodeIndex?clickedCircleColor:defaultCircleColor;ctx.shadowColor="rgba(0, 0, 0, 0.5)",ctx.shadowBlur=20,ctx.shadowOffsetX=4,ctx.shadowOffsetY=4,ctx.beginPath(),ctx.arc(e.x,e.y,e.r,0,2*Math.PI),ctx.fillStyle=n,ctx.fill(),ctx.lineWidth=2,ctx.strokeStyle="white",ctx.stroke(),ctx.shadowBlur=0,ctx.shadowOffsetX=0,ctx.shadowOffsetY=0})}function handleCanvasClick(e){const t=canvas.getBoundingClientRect(),n=(e.clientX-t.left)*(canvas.width/t.width),i=(e.clientY-t.top)*(canvas.height/t.height);let s=!1;circles.forEach((e,t)=>{const o=n-e.x,a=i-e.y;if(Math.sqrt(o*o+a*a)<=e.r){document.querySelector(".jspsych-btn").disabled=!1,clickedNodeIndex=t,console.log("Clicked on node:",clickedNodeIndex+1),s=!0}}),s&&drawDiagram()}function handleMouseMove(e){const t=canvas.getBoundingClientRect(),n=(e.clientX-t.left)*(canvas.width/t.width),i=(e.clientY-t.top)*(canvas.height/t.height);let s=-1;circles.forEach((e,t)=>{const o=n-e.x,a=i-e.y;Math.sqrt(o*o+a*a)<=e.r&&(s=t)}),drawDiagram(s)}function checkSum(){const e=document.getElementById("feedback");let t=document.getElementById("sum-input");if(!t.value)return e.textContent="\u8bf7\u8f93\u5165\u4e00\u4e2a\u6570\u5b57\uff01",void(e.style.color="red");{t.disabled=!0,document.querySelector(".jspsych-btn").disabled=!0;const n=parseInt(t.value,10);let i=sumNumbers.reduce((e,t)=>e+t,0);n===i?(calculation_money+=2,e.textContent="\u56de\u7b54\u6b63\u786e \uff01",e.style.color="green"):(e.textContent="\u56de\u7b54\u9519\u8bef\uff01\u6b63\u786e\u7b54\u6848\u4e3a"+i,e.style.color="red"),jsPsych.pluginAPI.setTimeout(()=>{jsPsych.finishTrial({rt:performance.now()-onset_time,response:n,Correct:n===i})},1e3)}}function drawQuestion(e){function t(){n.clearRect(0,l+80,e.width,e.height-l-100),o.forEach((e,t)=>{const i=d+t*(r+u);n.font=hoveredNodeIndex===t?'22px "Microsoft YaHei"':'20px "Microsoft YaHei"';const s=n.measureText(e).width,o={option:e,x:c,y:i-r/2,width:s+2*u,height:r};t===clickedNodeIndex?(n.fillStyle="blue",n.font='600 20px "Microsoft YaHei"'):n.fillStyle="black",n.fillText(e,c,i),h[t]=o})}const n=e.getContext("2d");n.clearRect(0,0,e.width,e.height),n.font='24px "Microsoft YaHei"';const i=multi_choice_items[trial_index],s=trial_index+1+". "+i.question,o=i.options;correctAnswerIndex=o.indexOf(i.answer);const a=100,l=180;n.fillText(s,a,l);const c=a,d=l+100,r=30,u=10,h=[];e.addEventListener("mousemove",function(n){const i=e.getBoundingClientRect(),s=(n.clientX-i.left)*(e.width/i.width),o=(n.clientY-i.top)*(e.height/i.height);hoveredNodeIndex=null,h.forEach((e,t)=>{s>=e.x&&s<=e.x+e.width&&o>=e.y&&o<=e.y+e.height&&(hoveredNodeIndex=t)}),t()}),e.addEventListener("click",function(n){const i=e.getBoundingClientRect(),s=(n.clientX-i.left)*(e.width/i.width),o=(n.clientY-i.top)*(e.height/i.height);h.forEach((e,t)=>{s>=e.x&&s<=e.x+e.width&&o>=e.y&&o<=e.y+e.height&&(clickedNodeIndex=t)}),t()}),t()}function checkAnswer(e){const t=document.querySelector("canvas").getContext("2d"),n=multi_choice_items[trial_index].options,i=multi_choice_items[trial_index].question,s=n[clickedNodeIndex];-1===clickedNodeIndex?(t.fillStyle="red",t.fillText("\u8bf7\u5148\u9009\u62e9\u4e00\u4e2a\u9009\u9879\uff01",100,440)):clickedNodeIndex===correctAnswerIndex?(multi_choice_money+=3,trial_index++,clickedNodeIndex=-1,e.target.disabled=!0,t.fillStyle="green",t.fillText("\u7b54\u6848\u6b63\u786e\uff01",100,440),jsPsych.pluginAPI.setTimeout(()=>{jsPsych.finishTrial({stimulus:i,response:s,correct:!0})},1e3)):(trial_index++,clickedNodeIndex=-1,e.target.disabled=!0,t.fillStyle="red",t.fillText("\u7b54\u6848\u9519\u8bef\uff01\u6b63\u786e\u7b54\u6848\u4e3a\uff1a"+n[correctAnswerIndex],100,440),jsPsych.pluginAPI.setTimeout(()=>{jsPsych.finishTrial({stimulus:i,response:s,correct:!1})},1e3))}function donation_main(){return{type:jsPsychHtmlKeyboardResponse,stimulus:()=>`\n    <div class="money-remaining">\n      \u5269\u4f59\u91d1\u989d\uff1a<span id="remainingMoney">${remaining_money}</span> \u5143\n  </div>\n    <div class="form-container">\n      <div class="question-container"></div>\n      <div class="option-container">\n        <input type="checkbox" id="noDonation" name="donationOptions" value="noDonation">\n        <label for="noDonation">\u6211\u9009\u62e9\u4e0d\u6350\u8d60</label>\n      </div>\n      <div class="option-container">\n        <input type="checkbox" id="yesDonation" name="donationOptions" value="yesDonation">\n        <label for="yesDonation">\u6211\u9009\u62e9\u6350\u8d60</label>\n        <div id="donationHint" class="donation-hint">, \u5e76\u4e14\u6350\u8d60<input type="number" id="donationAmount" class="donation-input" placeholder="\u8bf7\u8f93\u5165\u91d1\u989d">\u5143</div>\n      </div>\n      <button id="submitButton" class="jspsych-btn">\u63d0\u4ea4</button>\n      <p id="feedbackMessage"></p>\n  </div>\n    `,choices:"NO_KEYS",on_load:()=>{onset_time=performance.now();let e,t="";repeat_flag?(e=repeat_donation_program[trial_index],t=Math.random()>.5?e.planA:e.planB,t="\u7531\u4e8e\u4f60\u5e76\u6ca1\u6709\u8d2d\u4e70\u5173\u4e8e"+e.flag+"\u7684\u4fe1\u606f\uff0c\u6211\u4eec<h>\u514d\u8d39</h>\u4e3a\u4f60\u63d0\u4f9b\u6b64\u4fe1\u606f\u3002"+t):(e=donation_program[trial_index],t=if_buy?Math.random()>.5?e.planA:e.planB:"\u90a3\u4e48\u8fd9\u4e2a\u6148\u5584\u9879\u76ee\u53ef\u80fd\u4f1a\u9009\u62e9\u65b9\u6848A\u6216\u8005\u65b9\u6848B\uff0c\u5e76\u4e14<h>\u8fd9\u4e24\u4e2a\u65b9\u6848\u88ab\u9009\u62e9\u7684\u6982\u7387\u672a\u77e5</h>\uff0c\u90a3\u4e48\u4f60\u662f\u5426\u4f1a\u9009\u62e9\u6350\u8d60\uff1f\u4ee5\u53ca\u5982\u679c\u9009\u62e9\u6350\u8d60\u7684\u8bdd\u6350\u8d60\u7684\u91d1\u989d\u662f\u591a\u5c11\u5462\uff1f"),document.querySelector(".question-container").innerHTML=t;const n=document.getElementById("noDonation"),i=document.getElementById("yesDonation"),s=document.getElementById("donationAmount"),o=document.getElementById("donationHint"),a=document.getElementById("feedbackMessage"),l=document.getElementById("submitButton");i.addEventListener("change",function(){o.style.display=this.checked?"inline-block":"none",this.checked&&(n.checked=!1)}),n.addEventListener("change",function(){this.checked&&(i.checked=!1,o.style.display="none")}),l.addEventListener("click",function(){if(n.checked){n.disabled=!0,i.disabled=!0,s.disabled=!0,l.disabled=!0,a.textContent="\u60a8\u9009\u62e9\u4e86\u4e0d\u6350\u8d60\u3002",a.style.color="black";let e={stimulus:t,check_donation:!1};e.task_type=repeat_flag?"repeat_donation_main":"donation_main",jsPsych.pluginAPI.setTimeout(()=>{jsPsych.finishTrial(e)},1e3)}else if(i.checked){const e=s.value;if(e&&!isNaN(e)&&e>0&&e<=remaining_money){a.textContent=`\u60a8\u9009\u62e9\u6350\u8d60 ${e} \u5143\u3002`,a.style.color="green",remaining_money-=e,document.getElementById("remainingMoney").textContent=remaining_money,n.disabled=!0,i.disabled=!0,s.disabled=!0,l.disabled=!0;let o={check_donation:!0,response:e,stimulus:t};o.task_type=repeat_flag?"repeat_donation_main":"donation_main",jsPsych.pluginAPI.setTimeout(()=>{jsPsych.finishTrial(o)},1e3)}else a.textContent="\u8bf7\u8f93\u5165\u6709\u6548\u7684\u6350\u8d60\u91d1\u989d\u3002",a.style.color="red"}else a.textContent="\u8bf7\u9009\u62e9\u4e00\u9879\u6350\u8d60\u9009\u9879\u3002",a.style.color="red"})},on_finish:e=>{e.rt=performance.now()-onset_time,trial_index++}}}function drawWrappedChineseText(e,t,n,i,s,o){e.clearRect(0,0,e.width,e.height);let a="",l=i;for(const i of t){const t=a+i;e.measureText(t).width>s&&a.length>0?(e.fillText(a,n,l),a=i,l+=o):a=t}a&&e.fillText(a,n,l)}function checkSituation(){switch(program_name){case"\u7231\u5c0f\u4e2b\u5973\u751f\u52a0\u6cb9\u8ba1\u5212":return"\u8fd9\u4e2a\u9879\u76ee\u901a\u8fc7\u9001\u53bb\u5c0f\u4e2b\u5305\uff0c\u5f00\u5c55\u5c0f\u4e2b\u8bfe\u5802\uff0c\u4e3a\u6b20\u53d1\u8fbe\u5730\u533a\u5973\u5b69\u666e\u53ca\u751f\u7406\u536b\u751f\u548c\u81ea\u6211\u4fdd\u62a4\u7b49\u77e5\u8bc6\uff0c\u5e2e\u52a9\u5979\u4eec\u5065\u5eb7\u81ea\u4fe1\u7684\u6210\u957f\u3002";case"\u8ba9\u513f\u7ae5\u514d\u4e8e\u88ab\u6027\u4fb5":return"\u8fd9\u4e2a\u9879\u76ee\u9762\u5411\u6b20\u53d1\u8fbe\u5730\u533a\u7684\u4e61\u6751\u513f\u7ae5\u5f00\u5c55\u6027\u5b89\u5168\u5065\u5eb7\u6559\u80b2\u8bfe\u7a0b\uff0c\u5e76\u53d1\u653e\u5065\u5eb7\u536b\u751f\u5305\uff0c\u65e8\u5728\u666e\u53ca\u6027\u6559\u80b2\u77e5\u8bc6\u3001\u4fdd\u62a4\u513f\u7ae5\u8fdc\u79bb\u6027\u4fb5\u5bb3\u3002";case"\u5e2e\u5b9d\u8d1d\u6218\u80dc\u5148\u5929\u75c5":return"\u8fd9\u4e2a\u9879\u76ee\u4e3a\u4e86\u8ba9\u5148\u5929\u75c5\u60a3\u513f\u80fd\u63a5\u53d7\u6cbb\u7597\uff0c\u65e9\u65e5\u50cf\u6b63\u5e38\u7684\u5b69\u5b50\u4e00\u6837\u73a9\u800d\u3001\u5954\u8dd1\u3001\u5065\u5eb7\u6210\u957f\uff0c\u901a\u8fc7\u4e0e\u4f18\u79c0\u533b\u9662\u5408\u4f5c\uff0c\u8d44\u52a9\u5b64\u56f0\u5148\u5929\u75c5\u60a3\u513f\u63a5\u53d7\u6cbb\u7597\u3002";case"\u7ed9\u5b64\u513f\u5988\u5988\u822c\u7684\u7231":return'\u8fd9\u4e2a\u9879\u76ee\u6839\u636e\u5b64\u513f\u5404\u5e74\u9f84\u9636\u6bb5\u4ee5\u53ca\u4e0d\u540c\u6b8b\u969c\u7a0b\u5ea6\u7279\u9700\u513f\u7ae5\u7684\u53d1\u5c55\u7279\u70b9\uff0c\u8bbe\u8ba1\u6559\u5b66\u5185\u5bb9\u548c\u65b9\u6cd5\uff0c\u4e3a\u513f\u7ae5\u521b\u9020\u9002\u5408\u4ed6/\u5979\u7684\u6559\u80b2\u673a\u4f1a\u3002\u7cfb\u7edf\u5730\u57f9\u8bad\u4e0a\u5343\u540d"\u6625\u6656\u5988\u5988\u201d\uff0c\u6559\u4f1a\u5979\u4eec\u8fd0\u7528\u56de\u5e94\u5f0f\u6559\u80b2\u629a\u80b2\u7406\u5ff5\u4e0e\u798f\u5229\u9662\u513f\u7ae5\u5efa\u7acb\u60c5\u611f\u4f9d\u604b\uff0c\u6301\u7eed\u4e0d\u65ad\u5730\u56de\u5e94\u4ed6\u4eec\u7684\u9700\u6c42\uff0c\u5e2e\u52a9\u4ed6\u4eec\u5728\u5bb6\u5ead\u822c\u7684\u5173\u7231\u4e2d\u6210\u957f\u3002'}}const jsPsych=initJsPsych({auto_update_progress_bar:!0,extensions:[{type:Naodao}]}),main_timeline=[];donation_program=jsPsych.randomization.shuffle(donation_program);let sov_list,canvas,ctx,if_buy,sumNumbers,correctAnswerIndex,gained_money,remaining_money,program_name,selected_option,slider_value,modified_list=[],trial_index=0,onset_time=0,repeat_donation_program=[],repeat_flag=!1,calculation_money=0,multi_choice_money=0,donation_scale_list=jsPsych.randomization.shuffle([0,1,2,3,4,5,6,7,8,9]),deposit_scale_list=jsPsych.randomization.shuffle([0,1,2,3,4,5,6,7,8,9]);const xStart=100,yTopRect=120,rectWidth=60,rectHeight=45,circleRadius=15,spacing=120,circleDistance=30,circles=[],defaultRectColor="#4682B4",defaultCircleColor="#1592E6",defaultLineColor="#4682B4",clickedRectColor="#ff6347",clickedCircleColor="#ff6347",clickedLineColor="#ff6347";let clickedNodeIndex=-1,hoveredNodeIndex=-1,fullscreen={type:jsPsychFullscreen,message:FULLSCREEN,button_label:["\u5f00 \u59cb"]};main_timeline.push(fullscreen);const info={type:jsPsychSurveyHtmlForm,html:INFO,button_label:"\u7ee7\u7eed"};main_timeline.push(info);const sov_instruction={type:jsPsychHtmlButtonResponse,stimulus:()=>'\n    <div class="form-container">\n    <p>\u9996\u5148\uff0c\u60a8\u9700\u8981\u628a\u94b1\u5206\u7ed9\u60a8\u81ea\u5df1\u548c\u53e6\u4e00\u4f4d\u968f\u673a\u9009\u62e9\u7684\u53c2\u4e0e\u8005\u3002\u4e3a\u4e86\u4fdd\u8bc1\u533f\u540d\u6027\uff0c\u60a8\u4e0d\u4f1a\u77e5\u9053\u5bf9\u65b9\u662f\u8c01\uff0c\u5bf9\u65b9\u4e5f\u4e0d\u4f1a\u77e5\u9053\u60a8\u662f\u8c01\u3002\u60a8\u7684\u6240\u6709\u51b3\u5b9a\u90fd\u5c06\u4e25\u683c\u4fdd\u5bc6\u3002\u60a8\u7684\u51b3\u5b9a\u5c06\u540c\u65f6\u51b3\u5b9a\u60a8\u548c\u5bf9\u65b9\u6700\u540e\u7684\u5956\u91d1\u6570\u989d\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u4f60\u7684\u51b3\u5b9a\u4e0d\u4ec5\u4f1a\u5f71\u54cd\u4f60\u6536\u5230\u7684\u94b1\uff0c\u8fd8\u4f1a\u5f71\u54cd\u5bf9\u65b9\u6536\u5230\u7684\u94b1\u3002\u60a8\u5c06\u7ecf\u5386<h>\u603b\u5171\u516d\u8f6e\u6e38\u620f</h>\uff0c\u5728\u8fd9\u516d\u8f6e\u6e38\u620f\u4e2d\uff0c\u60a8\u5fc5\u987b\u5c06\u6240\u7ed9\u7684\u94b1\u5728\u81ea\u5df1\u548c\u5bf9\u65b9\u4e4b\u95f4\u8fdb\u884c\u5206\u914d\u3002\u6bcf\u8f6e\u53ea\u80fd\u9009\u62e9\u4e00\u4e2a\u9009\u9879\u3002\u8bf7\u5c3d\u91cf\u6309\u7167<b>\u4f60\u672c\u8eab\u7684\u610f\u613f</b>\u544a\u8bc9\u6211\u4eec\u60a8\u4f1a\u5982\u4f55\u5206\u914d\u8fd9\u7b14\u94b1\u3002\u7b54\u6848\u6ca1\u6709\u5bf9\u9519\u4e4b\u5206\u3002\u8fd9\u5b8c\u5168\u53d6\u51b3\u4e8e\u60a8\u7684\u4e2a\u4eba\u504f\u597d\u3002</p>\n    <p>\u4f8b\u5982\uff1a\u5728\u4e0b\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u8fd9\u4e2a\u4eba\u9009\u62e9\u4e86\u81ea\u5df1\u5f97\u523093\u4e2a\u5355\u4f4d\u7684\u94b1\uff0c\u53e6\u4e00\u4e2a\u4eba\u5c06\u5f97\u523033\u4e2a\u5355\u4f4d\u7684\u94b1\u3002\u8bf7\u6ce8\u610f\uff0c\u8fd9\u4e2a\u4eba\u7684\u9009\u62e9\u5c06\u51b3\u5b9a\u53e6\u4e00\u4e2a\u4eba\u7684\u5956\u91d1\u6570\u989d\u3002</p>\n    <img src="dist/asset/img/sov_example.png" alt="sov_example" width=1211 height=409 style=\'margin: 0 auto; max-width=750px; height: auto\'>\n    </div>\n    ',choices:["\u7ee7 \u7eed"]},SOV_procedure={type:jsPsychHtmlButtonResponse,stimulus:'<canvas id="diagram" width="1200" height="400"></canvas>',choices:["\u786e\u5b9a"],data:{task_type:"SOV"},on_load:()=>{document.querySelector(".jspsych-btn").disabled=!0,canvas=document.getElementById("diagram"),ctx=canvas.getContext("2d"),sov_list=SOV_DATA[trial_index],canvas.addEventListener("click",handleCanvasClick),canvas.addEventListener("mousemove",handleMouseMove),drawDiagram()},on_finish:e=>{e.sov_items=sov_list[clickedNodeIndex],e.response=clickedNodeIndex+1,trial_index++,clickedNodeIndex=-1}},SOV_timeline={timeline:[SOV_procedure],repetitions:6};main_timeline.push(sov_instruction,SOV_timeline);const reset_variables={type:jsPsychCallFunction,func:()=>{trial_index=0,clickedNodeIndex=-1,hoveredNodeIndex=-1}},sumNumber_instruction={type:jsPsychHtmlButtonResponse,stimulus:()=>'\n    <div class="form-container">\n    <p>\u63a5\u4e0b\u6765\u8fdb\u884c\u5b9e\u9a8c\u7684\u7b2c\u4e00\u90e8\u5206\uff0c\u5728\u8fd9\u4e00\u90e8\u5206\u5f00\u59cb\u4e4b\u524d\uff0c\u4f60\u9700\u8981\u901a\u8fc7\u56de\u7b54\u4e00\u4e9b\u8ba1\u7b97\u9898\u548c\u77e5\u8bc6\u95ee\u7b54\u9898\u6765\u8d5a\u53d6\u7b2c\u4e00\u90e8\u5206\u5b9e\u9a8c\u4e2d\u53ef\u4ee5\u652f\u914d\u7684\u91d1\u989d\uff0c\u4e00\u517120\u9053\u9898\uff0c\u5176\u4e2d10\u9053\u8ba1\u7b97\u9898\uff0c\u6bcf\u9053\u98982\u5757\u94b1\uff1b10\u9053\u77e5\u8bc6\u95ee\u7b54\uff0c\u6bcf\u9053\u98983\u5757\u94b1\u3002\u6bcf\u9053\u9898\u7b54\u9519\u5373\u4e0d\u7ed9\u94b1\u3002\u8bf7\u70b9\u51fb\u3010\u786e\u5b9a\u3011\u6309\u94ae\u5f00\u59cb\u7b54\u9898\u3002</p>\n    </div>\n    ',choices:["\u786e\u5b9a"]},sumNumber_procedure={timeline:[{type:jsPsychHtmlKeyboardResponse,stimulus:()=>{let e="<p>\u8bf7\u5728\u4e0b\u65b9\u8f93\u5165\u60a8\u770b\u5230\u7684\u6570\u5b57\u4e4b\u548c\u3002</p>";return e+='<div id="number-container">',(sumNumbers=Array.from({length:6},()=>Math.floor(9*Math.random())+1)).forEach((t,n)=>{e+=5===n?`<div class="number-box">${t}</div> = ?`:`<div class="number-box">${t}</div>+`}),e+="</div>",e+='<div id="answer-form">',e+='<label for="sum-input">\u8bf7\u8f93\u5165\u60a8\u7684\u7b54\u6848\uff1a</label>',e+='<input type="number" id="sum-input" />',e+='<input class="jspsych-btn" type="submit" value="\u63d0 \u4ea4" onclick="checkSum()" />',e+="</div>",e+='<div id="feedback"></div>',onset_time=performance.now(),e},choices:"NO_KEYS",data:{task_type:"sumNumber"}}],repetitions:10},sumNumber_timeline={timeline:[sumNumber_procedure,{type:jsPsychHtmlButtonResponse,stimulus:()=>{let e='<div class="form-container">';return e+="<h3>\u5728\u6570\u5b66\u8fd0\u7b97\u5b9e\u9a8c\u4e2d</h3>",e+="<p>\u60a8\u5171\u7b54\u5bf9"+parseInt(calculation_money/2)+"\u9053\u9898\u3002</p>",e+="<p\u60a8\u7684\u603b\u6536\u76ca\u4e3a"+calculation_money+"\u5143\u3002</p>",e+="<p>\u63a5\u4e0b\u6765\uff0c\u60a8\u5c06\u8fdb\u5165\u77e5\u8bc6\u95ee\u7b54\u73af\u8282\u3002</p>",e+="</div>"},choices:["\u7ee7 \u7eed"]}]};main_timeline.push(reset_variables,sumNumber_instruction,sumNumber_timeline);const multi_choice_procedure={timeline:[{type:jsPsychCanvasKeyboardResponse,stimulus:drawQuestion,canvas_size:[450,900],prompt:'<button id="submitButton" class="jspsych-btn">\u786e\u5b9a</button>',choices:"NO_KEYS",data:{task_type:"multi_choice"},on_load:()=>{document.getElementById("submitButton").addEventListener("click",checkAnswer)}}],repetitions:10},multi_choice_timeline={timeline:[multi_choice_procedure,{type:jsPsychHtmlButtonResponse,stimulus:()=>{let e="<p>\u7b54\u9898\u7ed3\u675f\uff0c\u606d\u559c\u4f60\u6311\u6218\u6210\u529f\uff01</p>";return e+=`<p>\u5728\u7b54\u9898\u73af\u8282\uff0c\u4f60\u603b\u5171\u7b54\u5bf9\u4e86\uff08${calculation_money/2}\uff09\u9053\u8ba1\u7b97\u9898\uff0c\uff08${multi_choice_money/3}\uff09\u9053\u77e5\u8bc6\u95ee\u7b54\uff0c\u603b\u5171\u83b7\u5f97\u4e86\uff08${gained_money=calculation_money+multi_choice_money}\uff09\u5143\u4f5c\u4e3a\u4f60\u63a5\u4e0b\u6765\u5b9e\u9a8c\u7684\u53ef\u652f\u914d\u91d1\u989d\u3002</p>`,onset_time=performance.now(),e},data:{task_type:"money_summary"},choices:["\u7ee7 \u7eed"],on_finish:e=>{e.rt=performance.now()-onset_time,e.response={calculation:calculation_money,multi_choice:multi_choice_money,total:calculation_money+multi_choice_money}}}]};main_timeline.push(reset_variables,multi_choice_timeline);const donation_tutorial={timeline:[{type:jsPsychHtmlButtonResponse,stimulus:()=>'\n        <div class="form-container">\n          <p>\u6211\u4eec\u9700\u8981\u4f60\u4e00\u8d77\u4e3a\u4e2d\u534e\u6148\u5584\u603b\u4f1a\u4e2d\u7684\u4e00\u4e9b\u6148\u5584\u9879\u76ee\u8fdb\u884c\u6350\u6b3e\uff0c\u5728\u4e0b\u9762\u7684\u73af\u8282\u4e2d\uff0c\u6211\u4eec\u8981\u4e3a\u8fd9\u4e9b\u9879\u76ee\u4e4b\u4e00\u5373\u201c\u4e3a\u4e86\u660e\u5929\uff0c\u5173\u7231\u513f\u7ae5\u201d\u9879\u76ee\u8fdb\u884c\u6350\u6b3e\uff0c\u8fd9\u4e2a\u9879\u76ee\u7684\u5ba3\u4f20\u8bed\u662f\uff1a\u201c\u6211\u4eec\u81f4\u529b\u4e8e\u7167\u4eae\u8d2b\u56f0\u5730\u533a\u5b69\u5b50\u7684\u672a\u6765\uff0c\u901a\u8fc7\u6559\u80b2\u8d4b\u4e88\u4ed6\u4eec\u6539\u53d8\u547d\u8fd0\u7684\u529b\u91cf\u3002\u60a8\u7684\u652f\u6301\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u5728\u8fd9\u4e9b\u793e\u533a\u5efa\u7acb\u5b66\u6821\u3001\u63d0\u4f9b\u5fc5\u8981\u7684\u6559\u80b2\u8d44\u6e90\uff0c\u5e76\u4e3a\u4ed6\u4eec\u5f00\u542f\u901a\u5f80\u77e5\u8bc6\u548c\u81ea\u6211\u63d0\u5347\u7684\u5927\u95e8\u3002\u201d</p>\n          <p>\u6b64\u73af\u8282<h>\u5206\u4e3a\u4e09\u8f6e</h>\uff0c\u6bcf\u4e00\u8f6e\u90fd\u4f1a\u8be2\u95ee\u4f60\u662f\u5426\u9700\u8981\u8d2d\u4e70\u8fd9\u4e2a\u6148\u5584\u9879\u76ee\u7684\u989d\u5916\u4fe1\u606f\uff0c\u5e76\u8fdb\u884c\u76f8\u5e94\u7684\u6350\u8d60\u9009\u62e9\u3002<h>\u6bcf\u4e00\u8f6e\u4e4b\u95f4\u76f8\u4e92\u72ec\u7acb\uff0c\u5373\u6bcf\u4e00\u8f6e\u4e2d\u4f60\u53ef\u4ee5\u652f\u914d\u7684\u91d1\u989d = \u521a\u521a\u8d5a\u53d6\u7684\u91d1\u989d</h>\uff0c\u6211\u4eec\u4f1a\u968f\u673a\u9009\u62e9\u4e00\u8f6e\u7684\u7ed3\u679c\u4f5c\u4e3a\u7b2c\u4e00\u90e8\u5206\u7684\u771f\u5b9e\u7ed3\u679c\u3002\u5982\u679c\u4f60\u5df2\u7ecf\u4e86\u89e3\uff0c\u8bf7\u6309\u7a7a\u683c\u952e\u8fdb\u884c\u786e\u8ba4\u3002</p>\n        </div>\n      ',choices:["\u7ee7\u7eed"]}]},donation_procedure={timeline:[{timeline:[{type:jsPsychHtmlButtonResponse,stimulus:()=>`\n            <div class="money-remaining">\u5269\u4f59\u91d1\u989d\uff1a<span id="remainingMoney">${gained_money}</span> \u5143</div>\n            <div class="form-container">\n            <div class="question-container"></div>\n            </div>\n            `,choices:["\u613f\u610f\u8d2d\u4e70","\u4e0d\u613f\u610f\u8d2d\u4e70"],data:{task_type:"buy_info"},on_load:()=>{let e=donation_program[trial_index];document.querySelector(".question-container").innerHTML=e.prompt},on_finish:e=>{let t=e.response;if_buy=!t,console.log("if buy",if_buy),remaining_money=if_buy?gained_money-5:gained_money,if_buy||repeat_donation_program.push(donation_program[trial_index])}},donation_main()],repetitions:3},{type:jsPsychCallFunction,func:()=>{repeat_flag=!0,trial_index=0}},{timeline:[{timeline:[donation_main()],loop_function:()=>trial_index<repeat_donation_program.length}],conditional_function:()=>repeat_donation_program.length}]};main_timeline.push(reset_variables,donation_procedure);const part2_tutorial={timeline:[{type:jsPsychHtmlButtonResponse,stimulus:()=>'<div class="form-container">\u4f60\u5df2\u7ecf\u5b8c\u6210\u4e86\u7b2c\u4e00\u90e8\u5206\u7684\u5b9e\u9a8c\uff0c\u53ef\u4ee5\u7a0d\u4f5c\u4f11\u606f\uff0c\u5f00\u59cb\u7b2c\u4e8c\u90e8\u5206\u7684\u5b9e\u9a8c\uff0c\u4f11\u606f\u597d\u4e86\u8bf7\u70b9\u51fb\u3010\u7ee7\u7eed\u3011\u6309\u94ae\u7ee7\u7eed\u5b9e\u9a8c\u3002\n      </div>',choices:["\u7ee7\u7eed"]}]};part2_donation={type:jsPsychCanvasKeyboardResponse,stimulus:e=>{function t(){n.clearRect(0,o+60,e.width,e.height-120),i.forEach((e,t)=>{const i=l+t*(c+d);n.font=hoveredNodeIndex===t?'22px "Microsoft YaHei"':'20px "Microsoft YaHei"';const s=n.measureText(e).width,o={option:e,x:a,y:i-c/2,width:s+2*d,height:c};t===clickedNodeIndex?(n.fillStyle="blue",n.font='600 20px "Microsoft YaHei"'):n.fillStyle="black",n.fillText(e,a,i),r[t]=o})}const n=e.getContext("2d");n.clearRect(0,0,e.width,e.height),n.font='20px "Microsoft YaHei"';const i=["\u6148\u5584\u60c5\u6696\u4e07\u5bb6","\u4e3a\u4e86\u660e\u5929 \u5173\u7231\u513f\u7ae5","\u5e73\u6c11\u82f1\u96c4\u5b88\u62a4","\u4e2d\u534e\u6148\u5584\u603b\u4f1a\u5fd7\u5fc3\u52a9\u519c"],s=100,o=150;drawWrappedChineseText(n,"\u9996\u5148\uff0c\u8bf7\u4ece\u4e0b\u9762\u7684\u6148\u5584\u9879\u76ee\u4e2d\u9009\u62e9\u4f60\u6700\u559c\u6b22\u7684\u9879\u76ee\uff08\u5373\u5982\u679c\u8ba9\u4f60\u7ed9\u4e0b\u9762\u9879\u76ee\u4e2d\u7684\u4e00\u4e2a\u6350\u6b3e\uff0c\u4f60\u4f1a\u9009\u62e9\u54ea\u4e00\u4e2a\uff1f\uff09\uff0c\u70b9\u51fb\u5bf9\u5e94\u7684\u9879\u76ee\uff1a",s,o,600,24);const a=s,l=o+90,c=30,d=10,r=[];e.addEventListener("mousemove",function(n){const i=e.getBoundingClientRect(),s=(n.clientX-i.left)*(e.width/i.width),o=(n.clientY-i.top)*(e.height/i.height);hoveredNodeIndex=null,r.forEach((e,t)=>{s>=e.x&&s<=e.x+e.width&&o>=e.y&&o<=e.y+e.height&&(hoveredNodeIndex=t)}),t()}),e.addEventListener("click",function(n){const i=e.getBoundingClientRect(),s=(n.clientX-i.left)*(e.width/i.width),o=(n.clientY-i.top)*(e.height/i.height);r.forEach((e,t)=>{s>=e.x&&s<=e.x+e.width&&o>=e.y&&o<=e.y+e.height&&(clickedNodeIndex=t)}),t()}),t()},prompt:'<button id="submitButton" class="jspsych-btn">\u786e\u5b9a</button>',on_load:()=>{let e=document.querySelector("#submitButton");e.addEventListener("click",function(){const t=document.querySelector("canvas").getContext("2d"),n=["\u6148\u5584\u60c5\u6696\u4e07\u5bb6","\u4e3a\u4e86\u660e\u5929 \u5173\u7231\u513f\u7ae5","\u5e73\u6c11\u82f1\u96c4\u5b88\u62a4","\u4e2d\u534e\u6148\u5584\u603b\u4f1a\u5fd7\u5fc3\u52a9\u519c"][clickedNodeIndex];console.log("selected_option",n),n?(e.disabled=!0,program_name=n,t.fillStyle="red",t.fillText("\u4f60\u9009\u62e9\u7684\u6148\u5584\u9879\u76ee\u4e3a\uff1a"+n,400,300),jsPsych.pluginAPI.setTimeout(()=>{jsPsych.finishTrial({stimulus:"\u9996\u5148\uff0c\u8bf7\u4ece\u4e0b\u9762\u7684\u6148\u5584\u9879\u76ee\u4e2d\u9009\u62e9\u4f60\u6700\u559c\u6b22\u7684\u9879\u76ee\uff08\u5373\u5982\u679c\u8ba9\u4f60\u7ed9\u4e0b\u9762\u9879\u76ee\u4e2d\u7684\u4e00\u4e2a\u6350\u6b3e\uff0c\u4f60\u4f1a\u9009\u62e9\u54ea\u4e00\u4e2a\uff1f\uff09\uff0c\u70b9\u51fb\u5bf9\u5e94\u7684\u9879\u76ee\uff1a",response:n})},1e3)):(t.fillStyle="red",t.fillText("\u8bf7\u9009\u62e9\u4e00\u4e2a\u6148\u5584\u9879\u76ee!",400,300))})},data:{task_type:"favorite-project-part2"},canvas_size:[400,900],choices:"NO_KEYS"},jsPsychHtmlButtonResponse;const part2_deposit={type:jsPsychHtmlButtonResponse,stimulus:()=>'\n    <div class="form-container">\u5728\u672c\u90e8\u5206\u4e2d\uff0c\u9664\u4e86\u60a8\u5c06\u56e0\u53c2\u4e0e\u5b9e\u9a8c\u800c\u83b7\u5f9720\u5143\u4e4b\u5916\uff0c\u6211\u4eec\u8fd8\u4e3a\u60a8\u63d0\u4f9b<h>\u989d\u591630\u5143</h>\u3002\u60a8\u53ef\u4ee5\u9009\u62e9<b>\u5c06\u8fd930\u5143\u76f4\u63a5\u7559\u7ed9\u81ea\u5df1\u52a0\u5728\u6700\u540e\u7684\u5b9e\u9a8c\u62a5\u916c\u4e2d</b>\uff0c\u4e5f\u53ef\u4ee5\u5c06<b>\u5c06\u90e8\u5206\u6216\u5168\u90e8\u50a8\u84c4\u5230\u6211\u4eec\u7684\u9879\u76ee\u4e2d\uff0c\u7b49\u5f85\u4e00\u4e2a\u6708\u540e\u6536\u5230\u50a8\u84c4\u90e8\u5206\u7684\u672c\u91d1\u548c\u5229\u6da6</b>\u3002\u6211\u4eec\u4f1a<b>\u968f\u673a\u9009\u62e9</b>\u60a8\u7684\u4e00\u4e2a\u5b9e\u9a8c\u51b3\u7b56\u4f5c\u4e3a\u6700\u7ec8\u7684\u7ed3\u679c\uff0c\u8bf7\u70b9\u51fb\u3010\u7ee7\u7eed\u3011\u786e\u8ba4\u3002\n    </div>\n    ',choices:["\u7ee7\u7eed"]};main_timeline.push({type:jsPsychCallFunction,func:()=>{remaining_money=30},reset_variables:reset_variables});const donation_task_procedure={timeline:[{type:jsPsychHtmlKeyboardResponse,stimulus:()=>`\n      <div class="money-remaining">\n        \u5269\u4f59\u91d1\u989d\uff1a<span id="remainingMoney">${remaining_money}</span> \u5143\n    </div>\n      <div class="form-container">\n        <div class="question-container"></div>\n        <div class="option-container">\n          \u8bf7\u8f93\u5165\u60f3\u8981\u6350\u8d60\u7684\u91d1\u989d\uff1a<input type="number" id="donationAmount" class="donation-input" placeholder="\u8bf7\u8f93\u5165\u91d1\u989d">\u5143</div>\n        </div>\n        <button id="submitButton" class="jspsych-btn">\u63d0\u4ea4</button>\n        <p id="feedbackMessage"></p>\n    </div>\n      `,choices:"NO_KEYS",on_load:()=>{onset_time=performance.now();let e=donation_scale_list[trial_index],t=`\u63a5\u4e0b\u6765\uff0c\u4f60\u8981\u4e3a\u201c${program_name}\u201d\u9879\u76ee\u8fdb\u884c\u6350\u6b3e\u3002\u5728\u8fd9\u4e2a\u9879\u76ee\u4e2d\uff0c\u60a8\u6bcf\u6350\u51fa1\u5143\u94b1\uff0c\u6211\u4eec\u5c31\u4f1a\u6350\u51fa<h>${e}\u5143</h>\uff0c\u8fd9\u6837\u201c${program_name}\u201d\u9879\u76ee\u5c31\u80fd\u6536\u5230\u60a8\u6350\u51fa\u7684<h>${e+1}\u500d</h>\u7684\u94b1\u3002\u90a3\u4e48\uff0c\u60a8\u60f3\u5411\u201c${program_name}\u201d\u9879\u76ee\u6350\u8d60 30\u5143\u4e2d\u7684\u591a\u5c11\uff1f\uff08\u6700\u9ad8\u6350\u8d60\u91d1\u989d\u4e3a30\u3002\u8bf7\u8bb0\u4f4f\uff0c\u60a8\u6bcf\u6350\u51fa1\u5143\u94b1\uff0c\u6211\u4eec\u5c31\u4f1a\u6350\u51fa<h>${e}\u5143</h>\u94b1\uff0c\u4f7f\u91d1\u989d\u7ffb<h>${e+1}\u500d</h>\u3002\uff09\n      `;document.querySelector(".question-container").innerHTML=t;const n=document.getElementById("donationAmount"),i=document.getElementById("feedbackMessage"),s=document.getElementById("submitButton");s.addEventListener("click",function(){const t=n.value;if(t&&!isNaN(t)&&t>=0&&t<=remaining_money){i.textContent=`\u60a8\u9009\u62e9\u6350\u8d60 ${t} \u5143\u3002`,i.style.color="green",remaining_money-=t,document.getElementById("remainingMoney").textContent=remaining_money,s.disabled=!0;let n={response:t,task_type:"donation_task",stimulus:e,rt:performance.now()-onset_time};jsPsych.pluginAPI.setTimeout(()=>{trial_index++,remaining_money=30,jsPsych.finishTrial(n)},1e3)}else i.textContent="\u8bf7\u8f93\u5165\u6709\u6548\u7684\u6350\u8d60\u91d1\u989d\u3002",i.style.color="red"})}}],repetitions:10},deposit_task_procedure={timeline:[{type:jsPsychHtmlKeyboardResponse,stimulus:()=>`\n      <div class="money-remaining">\n        \u5269\u4f59\u91d1\u989d\uff1a<span id="remainingMoney">${remaining_money}</span> \u5143\n    </div>\n      <div class="form-container">\n        <div class="question-container"></div>\n        <div class="option-container">\n          \u8bf7\u8f93\u5165\u60f3\u8981\u50a8\u84c4\u7684\u91d1\u989d\uff1a<input type="number" id="donationAmount" class="donation-input" placeholder="\u8bf7\u8f93\u5165\u91d1\u989d">\u5143</div>\n        </div>\n        <button id="submitButton" class="jspsych-btn">\u63d0\u4ea4</button>\n        <p id="feedbackMessage"></p>\n    </div>\n      `,choices:"NO_KEYS",on_load:()=>{onset_time=performance.now();let e=deposit_scale_list[trial_index],t=`\u63a5\u4e0b\u6765\uff0c\u4f60\u8981\u4e3a\u4f60\u81ea\u5df1\u8fdb\u884c\u50a8\u84c4\u3002\u5728\u672c\u6b21\u50a8\u84c4\u4e2d\uff0c\u60a8\u6bcf\u50a8\u84c41\u5143\u94b1\uff0c\u6211\u4eec\u5c31\u4f1a\u7ed9\u51fa<h>${e}\u5143</h>\u7684\u5229\u606f\uff0c\u8fd9\u6837\u4e00\u4e2a\u6708\u4e4b\u540e\u5c31\u4f60\u5c31\u80fd\u6536\u5230\u60a8\u50a8\u84c4\u90e8\u5206\u7684<h>${e+1}\u500d</h>\u7684\u94b1\u3002\u90a3\u4e48\uff0c\u60a8\u60f3\u4e3a\u4e00\u4e2a\u6708\u540e\u7684\u81ea\u5df1\u50a8\u84c430\u5143\u4e2d\u7684\u591a\u5c11\uff1f\uff08\u6700\u9ad8\u50a8\u84c4\u91d1\u989d\u4e3a30\u3002\u8bf7\u8bb0\u4f4f\uff0c\u60a8\u6bcf\u50a8\u84c41\u5143\u94b1\uff0c\u6211\u4eec\u5c31\u4f1a\u6350\u51fa<h>${e}\u5143</h>\u94b1\uff0c\u4f7f\u91d1\u989d\u7ffb<h>${e+1}\u500d</h>\u3002\uff09\n      `;document.querySelector(".question-container").innerHTML=t;const n=document.getElementById("donationAmount"),i=document.getElementById("feedbackMessage"),s=document.getElementById("submitButton");s.addEventListener("click",function(){const t=n.value;if(t&&!isNaN(t)&&t>=0&&t<=remaining_money){i.textContent=`\u60a8\u9009\u62e9\u50a8\u84c4 ${t} \u5143\u3002`,i.style.color="green",remaining_money-=t,document.getElementById("remainingMoney").textContent=remaining_money,s.disabled=!0;let n={response:t,task_type:"deposit_task",stimulus:e,rt:performance.now()-onset_time};jsPsych.pluginAPI.setTimeout(()=>{trial_index++,remaining_money=30,jsPsych.finishTrial(n)},1e3)}else i.textContent="\u8bf7\u8f93\u5165\u6709\u6548\u7684\u50a8\u84c4\u91d1\u989d\u3002",i.style.color="red"})}}],repetitions:10};main_timeline.push(part2_tutorial,part2_deposit,reset_variables,{type:jsPsychCallFunction,func:()=>{remaining_money=30}},deposit_task_procedure,reset_variables,{type:jsPsychCallFunction,func:()=>{remaining_money=30}},part2_donation,reset_variables,donation_task_procedure);const part3_tutorial={timeline:[{type:jsPsychHtmlButtonResponse,stimulus:()=>'<div class="form-container">\u4f60\u5df2\u7ecf\u5b8c\u6210\u4e86\u7b2c\u4e8c\u90e8\u5206\u7684\u5b9e\u9a8c\uff0c\u53ef\u4ee5\u7a0d\u4f5c\u4f11\u606f\uff0c\u5f00\u59cb\u7b2c\u4e09\u90e8\u5206\u7684\u5b9e\u9a8c\uff0c\u4f11\u606f\u597d\u4e86\u8bf7\u6309\u3010\u7ee7\u7eed\u3011\u6309\u94ae\u5f00\u59cb\u3002\n      </div>',choices:["\u7ee7\u7eed"]}]},part3_donation={timeline:[{type:jsPsychCanvasKeyboardResponse,stimulus:e=>{function t(){n.clearRect(0,o+60,e.width,e.height-120),i.forEach((e,t)=>{const i=l+t*(c+d);n.font=hoveredNodeIndex===t?'22px "Microsoft YaHei"':'20px "Microsoft YaHei"';const s=n.measureText(e).width,o={option:e,x:a,y:i-c/2,width:s+2*d,height:c};t===clickedNodeIndex?(n.fillStyle="blue",n.font='600 20px "Microsoft YaHei"'):n.fillStyle="black",n.fillText(e,a,i),r[t]=o})}const n=e.getContext("2d");n.clearRect(0,0,e.width,e.height),n.font='20px "Microsoft YaHei"';const i=["\u7231\u5c0f\u4e2b\u5973\u751f\u52a0\u6cb9\u8ba1\u5212","\u8ba9\u513f\u7ae5\u514d\u4e8e\u88ab\u6027\u4fb5","\u5e2e\u5b9d\u8d1d\u6218\u80dc\u5148\u5929\u75c5","\u7ed9\u5b64\u513f\u5988\u5988\u822c\u7684\u7231"],s=100,o=150;drawWrappedChineseText(n,"\u9996\u5148\uff0c\u548c\u7b2c\u4e8c\u90e8\u5206\u4e00\u6837\uff0c\u8bf7\u4ece\u4e0b\u9762\u7684\u6148\u5584\u9879\u76ee\u4e2d\u9009\u62e9\u4f60\u6700\u559c\u6b22\u7684\u9879\u76ee\uff08\u5373\u5982\u679c\u8ba9\u4f60\u7ed9\u4e0b\u9762\u9879\u76ee\u4e2d\u7684\u4e00\u4e2a\u6350\u6b3e\uff0c\u4f60\u4f1a\u9009\u62e9\u54ea\u4e00\u4e2a\uff1f\uff09\uff0c\u70b9\u51fb\u5bf9\u5e94\u7684\u9879\u76ee\uff1a",s,o,600,24);const a=s,l=o+100,c=30,d=10,r=[];e.addEventListener("mousemove",function(n){const i=e.getBoundingClientRect(),s=(n.clientX-i.left)*(e.width/i.width),o=(n.clientY-i.top)*(e.height/i.height);hoveredNodeIndex=null,r.forEach((e,t)=>{s>=e.x&&s<=e.x+e.width&&o>=e.y&&o<=e.y+e.height&&(hoveredNodeIndex=t)}),t()}),e.addEventListener("click",function(n){
const i=e.getBoundingClientRect(),s=(n.clientX-i.left)*(e.width/i.width),o=(n.clientY-i.top)*(e.height/i.height);r.forEach((e,t)=>{s>=e.x&&s<=e.x+e.width&&o>=e.y&&o<=e.y+e.height&&(clickedNodeIndex=t)}),t()}),t()},prompt:'<button id="submitButton" class="jspsych-btn">\u786e\u5b9a</button>',on_load:()=>{let e=document.querySelector("#submitButton");e.addEventListener("click",function(){const t=document.querySelector("canvas").getContext("2d"),n=["\u7231\u5c0f\u4e2b\u5973\u751f\u52a0\u6cb9\u8ba1\u5212","\u8ba9\u513f\u7ae5\u514d\u4e8e\u88ab\u6027\u4fb5","\u5e2e\u5b9d\u8d1d\u6218\u80dc\u5148\u5929\u75c5","\u7ed9\u5b64\u513f\u5988\u5988\u822c\u7684\u7231"][clickedNodeIndex];console.log("selected_option",n),n?(e.disabled=!0,program_name=n,t.fillStyle="red",t.fillText("\u4f60\u9009\u62e9\u7684\u6148\u5584\u9879\u76ee\u4e3a\uff1a"+n,400,300),jsPsych.pluginAPI.setTimeout(()=>{jsPsych.finishTrial({stimulus:"\u9996\u5148\uff0c\u548c\u7b2c\u4e8c\u90e8\u5206\u4e00\u6837\uff0c\u8bf7\u4ece\u4e0b\u9762\u7684\u6148\u5584\u9879\u76ee\u4e2d\u9009\u62e9\u4f60\u6700\u559c\u6b22\u7684\u9879\u76ee\uff08\u5373\u5982\u679c\u8ba9\u4f60\u7ed9\u4e0b\u9762\u9879\u76ee\u4e2d\u7684\u4e00\u4e2a\u6350\u6b3e\uff0c\u4f60\u4f1a\u9009\u62e9\u54ea\u4e00\u4e2a\uff1f\uff09\uff0c\u70b9\u51fb\u5bf9\u5e94\u7684\u9879\u76ee\uff1a",response:n})},1e3)):(t.fillStyle="red",t.fillText("\u8bf7\u9009\u62e9\u4e00\u4e2a\u6148\u5584\u9879\u76ee!",400,300))})},data:{task_type:"favorite-project-part3"},canvas_size:[400,900],choices:"NO_KEYS"},{type:jsPsychHtmlButtonResponse,stimulus:()=>'\n          <div class="form-container">\n          <p>\u5728\u8fd9\u4e00\u90e8\u5206\u4e2d\uff0c\u9996\u5148\u4f1a\u5448\u73b0\u4e00\u4e2a\u6350\u8d60\u60c5\u5883\uff0c\u5728\u6350\u8d60\u60c5\u5883\u4e4b\u540e\u4f1a\u5448\u73b0\u4e00\u4e9b\u6350\u8d60\u5b89\u6392\uff0c<h>\u6bcf\u4e00\u6b21\u6350\u8d60\u5b89\u6392\u72ec\u7acb\u5448\u73b0</h>\uff0c\u5728\u6bcf\u4e00\u6b21\u6350\u8d60\u5b89\u6392\u5448\u73b0\u4e4b\u540e\uff0c\u4f60\u9700\u8981\u9009\u62e9\u662f\u5426\u63a5\u53d7\u8fd9\u4e2a\u6350\u8d60\u5b89\u6392\uff0c\u5e76\u9009\u62e9\u4f60\u63a5\u53d7\u7684\u610f\u613f\u3002</p>\n          <p>\u8bf7\u6ce8\u610f\uff0c\u5728\u8fd9\u4e00\u90e8\u5206\uff0c\u6211\u4eec\u4e5f\u4f1a\u968f\u673a\u9009\u62e9\u4e00\u4e2a\u51b3\u7b56\u4f5c\u4e3a\u672c\u90e8\u5206\u7684\u7ed3\u679c\u3002\u6700\u7ec8\u7684\u7ed3\u679c\u662f<b>\u968f\u673a\u9009\u62e9</b>\u4e09\u4e2a\u5b9e\u9a8c\u90e8\u5206\u6240\u9009\u51fa\u7684\u4e09\u4e2a\u7ed3\u679c\u4e2d\u7684\u5176\u4e2d\u4e4b\u4e00\u8fdb\u884c\u6267\u884c\u3002\u8bf7\u70b9\u51fb\u3010\u7ee7 \u7eed\u3011\u6309\u94ae\u7ee7\u7eed\u5b9e\u9a8c\u3002</p>\n          </div>\n          ',choices:["\u7ee7\u7eed"]},{type:jsPsychHtmlButtonResponse,stimulus:()=>`\n          <div class="form-container"><p>\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u8981\u4e3a\u6148\u5584\u9879\u76ee\u8fdb\u884c\u6350\u6b3e\uff0c\u732e\u51fa\u81ea\u5df1\u7684\u4e00\u4efd\u7231\u5fc3\uff0c\u9879\u76ee\u540d\u79f0\u662f\u201c${program_name}\u201d\u3002</p>\n          <p>${checkSituation()}</p>\n          </div>\n          `,choices:["\u7ee7\u7eed"]},{type:jsPsychHtmlButtonResponse,stimulus:()=>'\n          <div class="form-container">\n          <p>\u5728\u968f\u540e\u7684\u6bcf\u4e00\u6b21\u6350\u8d60\u9009\u62e9\u4e2d\uff0c\u6211\u4eec\u4f1a\u5448\u73b0<h>\u4f60\u7684\u6350\u8d60\uff08\u7528\u997c\u72b6\u56fe\u4e2d\u7ea2\u8272\u7684\u90e8\u5206\u8fdb\u884c\u8868\u793a\uff09</h>\u4ee5\u53ca\u5bf9\u5e94\u7684<span style="color:green">\u5b9e\u9a8c\u8005\u6350\u6b3e\uff08\u4e5f\u5c31\u662f\u6211\u4eec\u9879\u76ee\u7ec4\u8981\u6350\u8d60\u7684\u91d1\u989d\uff0c\u7528\u997c\u72b6\u56fe\u4e2d\u7eff\u8272\u7684\u90e8\u5206\u8fdb\u884c\u8868\u793a\uff09</span>\uff0c\u8fd9\u4e24\u90e8\u5206\u7684\u548c\uff08\u6574\u4e2a\u997c\u72b6\u56fe\uff09\u5c31\u662f\u5728\u8fd9\u6b21\u6350\u8d60\u4e2d\u7684\u603b\u91d1\u989d\uff0c\u4f60\u9700\u8981\u5728\u6bcf\u4e00\u6b21\u5448\u73b0\u5b8c\u997c\u72b6\u56fe\u4e4b\u540e\u9009\u62e9<b>\u662f\u5426\u8fdb\u884c\u8fd9\u6837\u7684\u5b89\u6392</b>\uff0c\u9009\u62e9\u63a5\u53d7\u6216\u8005\u4e0d\u63a5\u53d7\uff08\u70b9\u51fb\u5bf9\u5e94\u7684\u6309\u94ae\uff09\u3002\u4ee5\u53ca\u4f60\u5728\u672c\u6b21\u6350\u8d60\u4e2d\u7684\u6350\u8d60\u610f\u613f\u662f\u591a\u5c11\uff08\u62d6\u52a8\u6ed1\u5757\uff09</p>\n   \n          </div>\n          ',choices:["\u7ee7\u7eed"]}]},part3_deposit={timeline:[{type:jsPsychHtmlButtonResponse,stimulus:()=>'\n        <div class="form-container"><p>\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u8981\u4e3a\u81ea\u5df1\u8fdb\u884c\u50a8\u84c4\u201d\u3002</p>\n        </div>\n        ',choices:["\u7ee7\u7eed"]},{type:jsPsychHtmlButtonResponse,stimulus:()=>'\n        <div class="form-container">\n        <p>\u5728\u6bcf\u4e00\u6b21\u50a8\u84c4\u9009\u62e9\u4e2d\uff0c\u6211\u4eec\u4f1a\u5448\u73b0<h>\u4f60\u7684\u50a8\u84c4\uff08\u7528\u997c\u72b6\u56fe\u4e2d\u7ea2\u8272\u7684\u90e8\u5206\u8fdb\u884c\u8868\u793a\uff09</h>\u4ee5\u53ca\u5bf9\u5e94\u7684<span style="color:green">\u5b9e\u9a8c\u8005\u7ed9\u60a8\u7684\u5229\u606f\uff08\u7528\u997c\u72b6\u56fe\u4e2d\u7eff\u8272\u7684\u90e8\u5206\u8fdb\u884c\u8868\u793a\uff09</span>\uff0c\u8fd9\u4e24\u90e8\u5206\u7684\u548c\uff08\u6574\u4e2a\u997c\u72b6\u56fe\uff09\u5c31\u662f\u60a8\u5728\u8fd9\u6b21\u50a8\u84c4\u4e2d\u7684\u83b7\u5f97\u7684\u603b\u91d1\u989d\uff0c\u4f60\u9700\u8981\u5728\u6bcf\u4e00\u6b21\u5448\u73b0\u5b8c\u997c\u72b6\u56fe\u4e4b\u540e\u9009\u62e9<b>\u662f\u5426\u8fdb\u884c\u8fd9\u6837\u7684\u5b89\u6392</b>\uff0c\u9009\u62e9\u63a5\u53d7\u6216\u8005\u4e0d\u63a5\u53d7\uff08\u70b9\u51fb\u5bf9\u5e94\u7684\u6309\u94ae\uff09\u3002\u4ee5\u53ca\u4f60\u5728\u672c\u6b21\u50a8\u84c4\u4e2d\u7684\u50a8\u84c4\u610f\u613f\u662f\u591a\u5c11\uff08\u62d6\u52a8\u6ed1\u5757\uff09\u3002</p>\n \n        </div>\n        ',choices:["\u7ee7\u7eed"]}]},chart_deposit_procedure1={timeline:[{type:jsPsychHtmlKeyboardResponse,stimulus:()=>'\n        <div class="form-container">\n        <h3>\u672c\u6b21\u7684\u50a8\u84c4\u662f\uff1a</h3>\n        <div class="donation-container">\n            <canvas id="donationCanvas" width="500" height="240"></canvas>\n        </div>\n\n        <div class="choice-container">\n        <p>\u4f60\u7684\u50a8\u84c4\u9009\u62e9\u662f\uff1a</p>\n        <button id="yes-button" class="jspsych-btn">\u50a8 \u84c4</button>\n        <button id="no-button" class="jspsych-btn">\u4e0d\u50a8\u84c4</button>\n    </div>\n        <p id="feedbackMessage"></p>\n        </div>\n        ',choices:"NO_KEYS",data:{task_type:"deposit+"+jsPsych.timelineVariable("taskType")},on_load:()=>{function e(e,t,n,i){const s=(t+n)/2,o=l+d/2*Math.cos(s),a=c+d/2*Math.sin(s);p.fillStyle=i,p.font="16px Microsoft YaHei",p.textAlign="center",p.textBaseline="middle",p.fillText(e,o,a)}function t(){document.getElementById("yes-button").disabled=!0,document.getElementById("no-button").disabled=!0}function n(){p.fillStyle="green",p.fillRect(r,u,20,h),p.fillStyle="black",p.font="14px Microsoft YaHei",p.textBaseline="middle",p.fillText("\u9879\u76ee\u7ec4\u5229\u606f",r+60,u+h/2),p.fillStyle="red",p.fillRect(r,u+h+m,20,h),p.fillStyle="black",p.fillText("\u4f60\u7684\u50a8\u84c4",r+60,u+h+m+h/2)}const i=jsPsych.timelineVariable("yours"),s=jsPsych.timelineVariable("program"),o=i+s,a=2*Math.PI*i/o,l=200,c=100,d=100,r=350,u=80,h=20,m=10,p=document.getElementById("donationCanvas").getContext("2d");p.beginPath(),p.moveTo(l,c),p.arc(l,c,d,-Math.PI/2,-Math.PI/2+a,!1),p.closePath(),p.fillStyle="red",p.fill(),p.beginPath(),p.moveTo(l,c),p.arc(l,c,d,-Math.PI/2+a,-Math.PI/2+2*Math.PI,!1),p.closePath(),p.fillStyle="green",p.fill(),e(`\xa5${i}`,-Math.PI/2,-Math.PI/2+a,"white"),e(`\xa5${s}`,-Math.PI/2+a,-Math.PI/2+2*Math.PI,"white"),n(),document.getElementById("yes-button").addEventListener("click",function(){t(),document.getElementById("feedbackMessage").textContent="\u60a8\u9009\u62e9\u50a8\u84c4\u3002",jsPsych.pluginAPI.setTimeout(()=>{jsPsych.finishTrial({response:1,yours:i,program:s})},1e3)}),document.getElementById("no-button").addEventListener("click",function(){t(),document.getElementById("feedbackMessage").textContent="\u60a8\u9009\u62e9\u4e0d\u50a8\u84c4\u3002",jsPsych.pluginAPI.setTimeout(()=>{jsPsych.finishTrial({response:0,yours:i,program:s})},1e3)})}},{type:jsPsychHtmlButtonResponse,stimulus:()=>'\n        <h3>\u672c\u6b21\u50a8\u84c4\u7684\u610f\u613f\u662f\u591a\u5c11\uff1f</h3>\n        <div class="slider-container">\n            <label for="slider" class="label">1\uff08\u6bd4\u8f83\u5c0f\u7684\u610f\u613f\uff09\u52305\uff08\u5f88\u5f3a\u70c8\u7684\u610f\u613f\uff09</label>\n            <input type="range" id="slider" min="1" max="5" value="1" step="1">\n            <div class="range-labels">\n                <span>1</span>\n                <span>2</span>\n                <span>3</span>\n                <span>4</span>\n                <span>5</span>\n            </div>\n        </div>\n        ',choices:["\u7ee7 \u7eed"],on_load:()=>{const e=document.getElementById("slider");e.addEventListener("input",()=>{e.style.background=`linear-gradient(to right, #4caf50 ${(e.value-1)/4*100}%, #d3d3d3 ${(e.value-1)/4*100}%)`}),document.querySelector(".jspsych-btn").addEventListener("click",()=>{slider_value=e.value})},data:{task_type:"deposit-slider"},on_finish:e=>{e.response=slider_value,e.yours=jsPsych.timelineVariable("yours"),e.program=jsPsych.timelineVariable("program")}}],timeline_variables:donation_part3_data1,randomize_order:!0},chart_deposit_procedure2={timeline:[{type:jsPsychHtmlKeyboardResponse,stimulus:()=>'\n        <div class="form-container">\n        <h3>\u672c\u6b21\u7684\u50a8\u84c4\u662f\uff1a</h3>\n        <div class="donation-container">\n            <canvas id="donationCanvas" width="500" height="240"></canvas>\n        </div>\n\n        <div class="choice-container">\n        <p>\u4f60\u7684\u50a8\u84c4\u9009\u62e9\u662f\uff1a</p>\n        <button id="yes-button" class="jspsych-btn">\u50a8 \u84c4</button>\n        <button id="no-button" class="jspsych-btn">\u4e0d\u50a8\u84c4</button>\n    </div>\n        <p id="feedbackMessage"></p>\n        </div>\n        ',choices:"NO_KEYS",data:{task_type:"deposit+"+jsPsych.timelineVariable("taskType")},on_load:()=>{function e(e,t,n,i){const s=(t+n)/2,o=l+d/2*Math.cos(s),a=c+d/2*Math.sin(s);p.fillStyle=i,p.font="16px Microsoft YaHei",p.textAlign="center",p.textBaseline="middle",p.fillText(e,o,a)}function t(){document.getElementById("yes-button").disabled=!0,document.getElementById("no-button").disabled=!0}function n(){p.fillStyle="green",p.fillRect(r,u,20,h),p.fillStyle="black",p.font="14px Microsoft YaHei",p.textBaseline="middle",p.fillText("\u9879\u76ee\u7ec4\u5229\u606f",r+60,u+h/2),p.fillStyle="red",p.fillRect(r,u+h+m,20,h),p.fillStyle="black",p.fillText("\u4f60\u7684\u50a8\u84c4",r+60,u+h+m+h/2)}const i=jsPsych.timelineVariable("yours"),s=jsPsych.timelineVariable("program"),o=i+s,a=2*Math.PI*i/o,l=200,c=100,d=100,r=350,u=80,h=20,m=10,p=document.getElementById("donationCanvas").getContext("2d");p.beginPath(),p.moveTo(l,c),p.arc(l,c,d,-Math.PI/2,-Math.PI/2+a,!1),p.closePath(),p.fillStyle="red",p.fill(),p.beginPath(),p.moveTo(l,c),p.arc(l,c,d,-Math.PI/2+a,-Math.PI/2+2*Math.PI,!1),p.closePath(),p.fillStyle="green",p.fill(),e(`\xa5${i}`,-Math.PI/2,-Math.PI/2+a,"white"),e(`\xa5${s}`,-Math.PI/2+a,-Math.PI/2+2*Math.PI,"white"),n(),document.getElementById("yes-button").addEventListener("click",function(){t(),document.getElementById("feedbackMessage").textContent="\u60a8\u9009\u62e9\u50a8\u84c4\u3002",jsPsych.pluginAPI.setTimeout(()=>{jsPsych.finishTrial({response:1,yours:i,program:s})},1e3)}),document.getElementById("no-button").addEventListener("click",function(){t(),document.getElementById("feedbackMessage").textContent="\u60a8\u9009\u62e9\u4e0d\u50a8\u84c4\u3002",jsPsych.pluginAPI.setTimeout(()=>{jsPsych.finishTrial({response:0,yours:i,program:s})},1e3)})}},{type:jsPsychHtmlButtonResponse,stimulus:()=>'\n        <h3>\u672c\u6b21\u50a8\u84c4\u7684\u610f\u613f\u662f\u591a\u5c11\uff1f</h3>\n        <div class="slider-container">\n            <label for="slider" class="label">1\uff08\u6bd4\u8f83\u5c0f\u7684\u610f\u613f\uff09\u52305\uff08\u5f88\u5f3a\u70c8\u7684\u610f\u613f\uff09</label>\n            <input type="range" id="slider" min="1" max="5" value="1" step="1">\n            <div class="range-labels">\n                <span>1</span>\n                <span>2</span>\n                <span>3</span>\n                <span>4</span>\n                <span>5</span>\n            </div>\n        </div>\n        ',choices:["\u7ee7 \u7eed"],on_load:()=>{const e=document.getElementById("slider");e.addEventListener("input",()=>{e.style.background=`linear-gradient(to right, #4caf50 ${(e.value-1)/4*100}%, #d3d3d3 ${(e.value-1)/4*100}%)`}),document.querySelector(".jspsych-btn").addEventListener("click",()=>{slider_value=e.value})},data:{task_type:"deposit-slider"},on_finish:e=>{e.response=slider_value,e.yours=jsPsych.timelineVariable("yours"),e.program=jsPsych.timelineVariable("program")}}],timeline_variables:donation_part3_data2,randomize_order:!0},chart_deposit_procedure3={timeline:[{type:jsPsychHtmlKeyboardResponse,stimulus:()=>'\n        <div class="form-container">\n        <h3>\u672c\u6b21\u7684\u50a8\u84c4\u662f\uff1a</h3>\n        <div class="donation-container">\n            <canvas id="donationCanvas" width="500" height="240"></canvas>\n        </div>\n\n        <div class="choice-container">\n        <p>\u4f60\u7684\u50a8\u84c4\u9009\u62e9\u662f\uff1a</p>\n        <button id="yes-button" class="jspsych-btn">\u50a8 \u84c4</button>\n        <button id="no-button" class="jspsych-btn">\u4e0d\u50a8\u84c4</button>\n    </div>\n        <p id="feedbackMessage"></p>\n        </div>\n        ',choices:"NO_KEYS",data:{task_type:"deposit+"+jsPsych.timelineVariable("taskType")},on_load:()=>{function e(e,t,n,i){const s=(t+n)/2,o=l+d/2*Math.cos(s),a=c+d/2*Math.sin(s);p.fillStyle=i,p.font="16px Microsoft YaHei",p.textAlign="center",p.textBaseline="middle",p.fillText(e,o,a)}function t(){document.getElementById("yes-button").disabled=!0,document.getElementById("no-button").disabled=!0}function n(){p.fillStyle="green",p.fillRect(r,u,20,h),p.fillStyle="black",p.font="14px Microsoft YaHei",p.textBaseline="middle",p.fillText("\u9879\u76ee\u7ec4\u5229\u606f",r+60,u+h/2),p.fillStyle="red",p.fillRect(r,u+h+m,20,h),p.fillStyle="black",p.fillText("\u4f60\u7684\u50a8\u84c4",r+60,u+h+m+h/2)}const i=jsPsych.timelineVariable("yours"),s=jsPsych.timelineVariable("program"),o=i+s,a=2*Math.PI*i/o,l=200,c=100,d=100,r=350,u=80,h=20,m=10,p=document.getElementById("donationCanvas").getContext("2d");p.beginPath(),p.moveTo(l,c),p.arc(l,c,d,-Math.PI/2,-Math.PI/2+a,!1),p.closePath(),p.fillStyle="red",p.fill(),p.beginPath(),p.moveTo(l,c),p.arc(l,c,d,-Math.PI/2+a,-Math.PI/2+2*Math.PI,!1),p.closePath(),p.fillStyle="green",p.fill(),e(`\xa5${i}`,-Math.PI/2,-Math.PI/2+a,"white"),e(`\xa5${s}`,-Math.PI/2+a,-Math.PI/2+2*Math.PI,"white"),n(),document.getElementById("yes-button").addEventListener("click",function(){t(),document.getElementById("feedbackMessage").textContent="\u60a8\u9009\u62e9\u50a8\u84c4\u3002",jsPsych.pluginAPI.setTimeout(()=>{jsPsych.finishTrial({response:1,yours:i,program:s})},1e3)}),document.getElementById("no-button").addEventListener("click",function(){t(),document.getElementById("feedbackMessage").textContent="\u60a8\u9009\u62e9\u4e0d\u50a8\u84c4\u3002",jsPsych.pluginAPI.setTimeout(()=>{jsPsych.finishTrial({response:0,yours:i,program:s})},1e3)})}},{type:jsPsychHtmlButtonResponse,stimulus:()=>'\n        <h3>\u672c\u6b21\u50a8\u84c4\u7684\u610f\u613f\u662f\u591a\u5c11\uff1f</h3>\n        <div class="slider-container">\n            <label for="slider" class="label">1\uff08\u6bd4\u8f83\u5c0f\u7684\u610f\u613f\uff09\u52305\uff08\u5f88\u5f3a\u70c8\u7684\u610f\u613f\uff09</label>\n            <input type="range" id="slider" min="1" max="5" value="1" step="1">\n            <div class="range-labels">\n                <span>1</span>\n                <span>2</span>\n                <span>3</span>\n                <span>4</span>\n                <span>5</span>\n            </div>\n        </div>\n        ',choices:["\u7ee7 \u7eed"],on_load:()=>{const e=document.getElementById("slider");e.addEventListener("input",()=>{e.style.background=`linear-gradient(to right, #4caf50 ${(e.value-1)/4*100}%, #d3d3d3 ${(e.value-1)/4*100}%)`}),document.querySelector(".jspsych-btn").addEventListener("click",()=>{slider_value=e.value})},data:{task_type:"deposit-slider"},on_finish:e=>{e.response=slider_value,e.yours=jsPsych.timelineVariable("yours"),e.program=jsPsych.timelineVariable("program")}}],timeline_variables:donation_part3_data3,randomize_order:!0},chart_donation_procedure1={timeline:[{type:jsPsychHtmlKeyboardResponse,stimulus:()=>'\n        <div class="form-container">\n        <h3>\u672c\u6b21\u7684\u6350\u8d60\u662f\uff1a</h3>\n        <div class="donation-container">\n            <canvas id="donationCanvas" width="500" height="240"></canvas>\n        </div>\n\n        <div class="choice-container">\n        <p>\u4f60\u7684\u6350\u8d60\u9009\u62e9\u662f\uff1a</p>\n        <button id="yes-button" class="jspsych-btn">\u6350  \u8d60</button>\n        <button id="no-button" class="jspsych-btn">\u4e0d\u6350\u8d60</button>\n    </div>\n        <p id="feedbackMessage"></p>\n        </div>\n        ',choices:"NO_KEYS",data:{task_type:"donation+"+jsPsych.timelineVariable("taskType")},on_load:()=>{function e(e,t,n,i){const s=(t+n)/2,o=l+d/2*Math.cos(s),a=c+d/2*Math.sin(s);p.fillStyle=i,p.font="16px Microsoft YaHei",p.textAlign="center",p.textBaseline="middle",p.fillText(e,o,a)}function t(){document.getElementById("yes-button").disabled=!0,document.getElementById("no-button").disabled=!0}function n(){p.fillStyle="green",p.fillRect(r,u,20,h),p.fillStyle="black",p.font="14px Microsoft YaHei",p.textBaseline="middle",p.fillText("\u9879\u76ee\u7ec4\u6350\u8d60",r+60,u+h/2),p.fillStyle="red",p.fillRect(r,u+h+m,20,h),p.fillStyle="black",p.fillText("\u4f60\u7684\u6350\u8d60",r+60,u+h+m+h/2)}const i=jsPsych.timelineVariable("yours"),s=jsPsych.timelineVariable("program"),o=i+s,a=2*Math.PI*i/o,l=200,c=100,d=100,r=350,u=80,h=20,m=10,p=document.getElementById("donationCanvas").getContext("2d");p.beginPath(),p.moveTo(l,c),p.arc(l,c,d,-Math.PI/2,-Math.PI/2+a,!1),p.closePath(),p.fillStyle="red",p.fill(),p.beginPath(),p.moveTo(l,c),p.arc(l,c,d,-Math.PI/2+a,-Math.PI/2+2*Math.PI,!1),p.closePath(),p.fillStyle="green",p.fill(),e(`\xa5${i}`,-Math.PI/2,-Math.PI/2+a,"white"),e(`\xa5${s}`,-Math.PI/2+a,-Math.PI/2+2*Math.PI,"white"),n(),document.getElementById("yes-button").addEventListener("click",function(){t(),document.getElementById("feedbackMessage").textContent="\u60a8\u9009\u62e9\u6350\u8d60\u3002",jsPsych.pluginAPI.setTimeout(()=>{jsPsych.finishTrial({response:1,yours:i,program:s})},1e3)}),document.getElementById("no-button").addEventListener("click",function(){t(),document.getElementById("feedbackMessage").textContent="\u60a8\u9009\u62e9\u4e0d\u6350\u8d60\u3002",jsPsych.pluginAPI.setTimeout(()=>{jsPsych.finishTrial({response:0,yours:i,program:s})},1e3)})}},{type:jsPsychHtmlButtonResponse,stimulus:()=>'\n        <h3>\u672c\u6b21\u6350\u8d60\u7684\u610f\u613f\u662f\u591a\u5c11\uff1f</h3>\n        <div class="slider-container">\n            <label for="slider" class="label">1\uff08\u6bd4\u8f83\u5c0f\u7684\u610f\u613f\uff09\u52305\uff08\u5f88\u5f3a\u70c8\u7684\u610f\u613f\uff09</label>\n            <input type="range" id="slider" min="1" max="5" value="1" step="1">\n            <div class="range-labels">\n                <span>1</span>\n                <span>2</span>\n                <span>3</span>\n                <span>4</span>\n                <span>5</span>\n            </div>\n        </div>\n        ',choices:["\u7ee7 \u7eed"],on_load:()=>{const e=document.getElementById("slider");e.addEventListener("input",()=>{e.style.background=`linear-gradient(to right, #4caf50 ${(e.value-1)/4*100}%, #d3d3d3 ${(e.value-1)/4*100}%)`}),document.querySelector(".jspsych-btn").addEventListener("click",()=>{slider_value=e.value})},data:{task_type:"donation-slider"},on_finish:e=>{e.response=slider_value,e.yours=jsPsych.timelineVariable("yours"),e.program=jsPsych.timelineVariable("program")}}],timeline_variables:donation_part3_data1,randomize_order:!0},chart_donation_procedure2={timeline:[{type:jsPsychHtmlKeyboardResponse,stimulus:()=>'\n        <div class="form-container">\n        <h3>\u672c\u6b21\u7684\u6350\u8d60\u662f\uff1a</h3>\n        <div class="donation-container">\n            <canvas id="donationCanvas" width="500" height="240"></canvas>\n        </div>\n\n        <div class="choice-container">\n        <p>\u4f60\u7684\u6350\u8d60\u9009\u62e9\u662f\uff1a</p>\n        <button id="yes-button" class="jspsych-btn">\u6350  \u8d60</button>\n        <button id="no-button" class="jspsych-btn">\u4e0d\u6350\u8d60</button>\n    </div>\n        <p id="feedbackMessage"></p>\n        </div>\n        ',choices:"NO_KEYS",data:{task_type:"donation+"+jsPsych.timelineVariable("taskType")},on_load:()=>{function e(e,t,n,i){const s=(t+n)/2,o=l+d/2*Math.cos(s),a=c+d/2*Math.sin(s);p.fillStyle=i,p.font="16px Microsoft YaHei",p.textAlign="center",p.textBaseline="middle",p.fillText(e,o,a)}function t(){document.getElementById("yes-button").disabled=!0,document.getElementById("no-button").disabled=!0}function n(){p.fillStyle="green",p.fillRect(r,u,20,h),p.fillStyle="black",p.font="14px Microsoft YaHei",p.textBaseline="middle",p.fillText("\u9879\u76ee\u7ec4\u6350\u8d60",r+60,u+h/2),p.fillStyle="red",p.fillRect(r,u+h+m,20,h),p.fillStyle="black",p.fillText("\u4f60\u7684\u6350\u8d60",r+60,u+h+m+h/2)}const i=jsPsych.timelineVariable("yours"),s=jsPsych.timelineVariable("program"),o=i+s,a=2*Math.PI*i/o,l=200,c=100,d=100,r=350,u=80,h=20,m=10,p=document.getElementById("donationCanvas").getContext("2d");p.beginPath(),p.moveTo(l,c),p.arc(l,c,d,-Math.PI/2,-Math.PI/2+a,!1),p.closePath(),p.fillStyle="red",p.fill(),p.beginPath(),p.moveTo(l,c),p.arc(l,c,d,-Math.PI/2+a,-Math.PI/2+2*Math.PI,!1),p.closePath(),p.fillStyle="green",p.fill(),e(`\xa5${i}`,-Math.PI/2,-Math.PI/2+a,"white"),e(`\xa5${s}`,-Math.PI/2+a,-Math.PI/2+2*Math.PI,"white"),n(),document.getElementById("yes-button").addEventListener("click",function(){t(),document.getElementById("feedbackMessage").textContent="\u60a8\u9009\u62e9\u6350\u8d60\u3002",jsPsych.pluginAPI.setTimeout(()=>{jsPsych.finishTrial({response:1,yours:i,program:s})},1e3)}),document.getElementById("no-button").addEventListener("click",function(){t(),document.getElementById("feedbackMessage").textContent="\u60a8\u9009\u62e9\u4e0d\u6350\u8d60\u3002",jsPsych.pluginAPI.setTimeout(()=>{jsPsych.finishTrial({response:0,yours:i,program:s})},1e3)})}},{type:jsPsychHtmlButtonResponse,stimulus:()=>'\n        <h3>\u672c\u6b21\u6350\u8d60\u7684\u610f\u613f\u662f\u591a\u5c11\uff1f</h3>\n        <div class="slider-container">\n            <label for="slider" class="label">1\uff08\u6bd4\u8f83\u5c0f\u7684\u610f\u613f\uff09\u52305\uff08\u5f88\u5f3a\u70c8\u7684\u610f\u613f\uff09</label>\n            <input type="range" id="slider" min="1" max="5" value="1" step="1">\n            <div class="range-labels">\n                <span>1</span>\n                <span>2</span>\n                <span>3</span>\n                <span>4</span>\n                <span>5</span>\n            </div>\n        </div>\n        ',choices:["\u7ee7 \u7eed"],on_load:()=>{const e=document.getElementById("slider");e.addEventListener("input",()=>{e.style.background=`linear-gradient(to right, #4caf50 ${(e.value-1)/4*100}%, #d3d3d3 ${(e.value-1)/4*100}%)`}),document.querySelector(".jspsych-btn").addEventListener("click",()=>{slider_value=e.value})},data:{task_type:"donation-slider"},on_finish:e=>{e.response=slider_value,e.yours=jsPsych.timelineVariable("yours"),e.program=jsPsych.timelineVariable("program")}}],timeline_variables:donation_part3_data2,randomize_order:!0},chart_donation_procedure3={timeline:[{type:jsPsychHtmlKeyboardResponse,stimulus:()=>'\n        <div class="form-container">\n        <h3>\u672c\u6b21\u7684\u6350\u8d60\u662f\uff1a</h3>\n        <div class="donation-container">\n            <canvas id="donationCanvas" width="500" height="240"></canvas>\n        </div>\n\n        <div class="choice-container">\n        <p>\u4f60\u7684\u6350\u8d60\u9009\u62e9\u662f\uff1a</p>\n        <button id="yes-button" class="jspsych-btn">\u6350  \u8d60</button>\n        <button id="no-button" class="jspsych-btn">\u4e0d\u6350\u8d60</button>\n    </div>\n        <p id="feedbackMessage"></p>\n        </div>\n        ',choices:"NO_KEYS",data:{task_type:"donation+"+jsPsych.timelineVariable("taskType")},on_load:()=>{function e(e,t,n,i){const s=(t+n)/2,o=l+d/2*Math.cos(s),a=c+d/2*Math.sin(s);p.fillStyle=i,p.font="16px Microsoft YaHei",p.textAlign="center",p.textBaseline="middle",p.fillText(e,o,a)}function t(){document.getElementById("yes-button").disabled=!0,document.getElementById("no-button").disabled=!0}function n(){p.fillStyle="green",p.fillRect(r,u,20,h),p.fillStyle="black",p.font="14px Microsoft YaHei",p.textBaseline="middle",p.fillText("\u9879\u76ee\u7ec4\u6350\u8d60",r+60,u+h/2),p.fillStyle="red",p.fillRect(r,u+h+m,20,h),p.fillStyle="black",p.fillText("\u4f60\u7684\u6350\u8d60",r+60,u+h+m+h/2)}const i=jsPsych.timelineVariable("yours"),s=jsPsych.timelineVariable("program"),o=i+s,a=2*Math.PI*i/o,l=200,c=100,d=100,r=350,u=80,h=20,m=10,p=document.getElementById("donationCanvas").getContext("2d");p.beginPath(),p.moveTo(l,c),p.arc(l,c,d,-Math.PI/2,-Math.PI/2+a,!1),p.closePath(),p.fillStyle="red",p.fill(),p.beginPath(),p.moveTo(l,c),p.arc(l,c,d,-Math.PI/2+a,-Math.PI/2+2*Math.PI,!1),p.closePath(),p.fillStyle="green",p.fill(),e(`\xa5${i}`,-Math.PI/2,-Math.PI/2+a,"white"),e(`\xa5${s}`,-Math.PI/2+a,-Math.PI/2+2*Math.PI,"white"),n(),document.getElementById("yes-button").addEventListener("click",function(){t(),document.getElementById("feedbackMessage").textContent="\u60a8\u9009\u62e9\u6350\u8d60\u3002",jsPsych.pluginAPI.setTimeout(()=>{jsPsych.finishTrial({response:1,yours:i,program:s})},1e3)}),document.getElementById("no-button").addEventListener("click",function(){t(),document.getElementById("feedbackMessage").textContent="\u60a8\u9009\u62e9\u4e0d\u6350\u8d60\u3002",jsPsych.pluginAPI.setTimeout(()=>{jsPsych.finishTrial({response:0,yours:i,program:s})},1e3)})}},{type:jsPsychHtmlButtonResponse,stimulus:()=>'\n        <h3>\u672c\u6b21\u6350\u8d60\u7684\u610f\u613f\u662f\u591a\u5c11\uff1f</h3>\n        <div class="slider-container">\n            <label for="slider" class="label">1\uff08\u6bd4\u8f83\u5c0f\u7684\u610f\u613f\uff09\u52305\uff08\u5f88\u5f3a\u70c8\u7684\u610f\u613f\uff09</label>\n            <input type="range" id="slider" min="1" max="5" value="1" step="1">\n            <div class="range-labels">\n                <span>1</span>\n                <span>2</span>\n                <span>3</span>\n                <span>4</span>\n                <span>5</span>\n            </div>\n        </div>\n        ',choices:["\u7ee7 \u7eed"],on_load:()=>{const e=document.getElementById("slider");e.addEventListener("input",()=>{e.style.background=`linear-gradient(to right, #4caf50 ${(e.value-1)/4*100}%, #d3d3d3 ${(e.value-1)/4*100}%)`}),document.querySelector(".jspsych-btn").addEventListener("click",()=>{slider_value=e.value})},data:{task_type:"donation-slider"},on_finish:e=>{e.response=slider_value,e.yours=jsPsych.timelineVariable("yours"),e.program=jsPsych.timelineVariable("program")}}],timeline_variables:donation_part3_data3,randomize_order:!0},chart_deposit_procedure_timeline1={timeline:[{type:jsPsychHtmlButtonResponse,stimulus:()=>'\n        <div class="form-container">\n        <p>\u5728\u63a5\u4e0b\u6765\u7684\u90e8\u5206\u4e2d\uff0c\u60a8\u5c06\u770b\u5230\u4e24\u4e2a\u90e8\u5206\u7684\u50a8\u84c4\uff1a<h>\u60a8\u7684\u50a8\u84c4\u90e8\u5206\uff08\u4ee5\u7ea2\u8272\u663e\u793a\u7684\u997c\u72b6\u56fe\u533a\u57df\uff09</h>\u548c\u76f8\u5e94\u7684<span style="color:green">\u5b9e\u9a8c\u8005\u7ed9\u60a8\u7684\u5229\u606f\uff08\u4ee5\u7eff\u8272\u663e\u793a\u7684\u997c\u72b6\u56fe\u533a\u57df\uff09</span>\u3002\u8fd9\u4e24\u90e8\u5206\u7684<h>\u603b\u548c\u5c06\u4fdd\u6301\u4e3a 100 \u5143</h>\u3002\u65e0\u8bba\u60a8\u9009\u62e9\u7684\u50a8\u84c4\u989d\u5ea6\u662f\u591a\u5c11\uff0c\u5b9e\u9a8c\u8005\u90fd\u4f1a\u8865\u8db3\u5230 100 \u5143\u7684\u603b\u989d\u3002</p>\n        </div>\n        ',choices:["\u7ee7\u7eed"]},chart_deposit_procedure1]},chart_donation_procedure_timeline1={timeline:[{type:jsPsychHtmlButtonResponse,stimulus:()=>'\n        <div class="form-container">\n        <p>\u5728\u63a5\u4e0b\u6765\u7684\u90e8\u5206\u4e2d\uff0c\u60a8\u5c06\u770b\u5230\u4e24\u4e2a\u90e8\u5206\u7684\u6350\u8d60\u5206\u914d\uff1a<h>\u60a8\u7684\u6350\u8d60\u90e8\u5206\uff08\u4ee5\u7ea2\u8272\u663e\u793a\u7684\u997c\u72b6\u56fe\u533a\u57df\uff09</h>\u548c\u76f8\u5e94\u7684<span style="color:green">\u5b9e\u9a8c\u8005\u7684\u6350\u8d60\u90e8\u5206\uff08\u4ee5\u7eff\u8272\u663e\u793a\u7684\u997c\u72b6\u56fe\u533a\u57df\uff09</span>\u3002\u8fd9\u4e24\u90e8\u5206\u7684<h>\u603b\u548c\u5c06\u4fdd\u6301\u4e3a 100 \u5143</h>\u3002\u65e0\u8bba\u60a8\u9009\u62e9\u7684\u6350\u8d60\u989d\u5ea6\u662f\u591a\u5c11\uff0c\u5b9e\u9a8c\u8005\u90fd\u4f1a\u8865\u8db3\u5230 100 \u5143\u7684\u603b\u989d</p>\n        </div>\n        ',choices:["\u7ee7\u7eed"]},chart_donation_procedure1]},chart_donation_procedure_timeline2={timeline:[{type:jsPsychHtmlButtonResponse,stimulus:()=>'\n        <div class="form-container">\n        <p>\u5728\u63a5\u4e0b\u6765\u7684\u8bd5\u6b21\u4e2d\uff0c\u60a8\u5c06\u770b\u5230\u4e0d\u540c\u7684\u6350\u8d60\u5b89\u6392\u3002\u4e0e\u4e4b\u524d\u7684\u89c4\u5219\u4e0d\u540c\uff0c\u60a8\u548c\u5bf9\u5e94\u7684\u5b9e\u9a8c\u8005\u7684\u6350\u8d60<h>\u603b\u548c\u5c06\u4e0d\u56fa\u5b9a</h>\u3002\u8bf7\u6ce8\u610f\uff0c\u60a8\u7684\u6350\u8d60\u989d\u5ea6\u5728\u6bcf\u6b21\u9009\u62e9\u65f6\u4f1a\u53d7\u5230 <h>20 \u5143\u7684\u9650\u5236</h>\u3002</p>\n        </div>\n        ',choices:["\u7ee7\u7eed"]},chart_donation_procedure2]},chart_deposit_procedure_timeline2={timeline:[{type:jsPsychHtmlButtonResponse,stimulus:()=>'\n        <div class="form-container">\n        <p>\u5728\u63a5\u4e0b\u6765\u7684\u8bd5\u6b21\u4e2d\uff0c\u60a8\u5c06\u770b\u5230\u4e0d\u540c\u7684\u50a8\u84c4\u5b89\u6392\u3002\u4e0e\u4e4b\u524d\u7684\u89c4\u5219\u4e0d\u540c\uff0c\u60a8\u6536\u5230\u7684\u50a8\u84c4\u91d1\u989d\u7684<h>\u603b\u548c\u5c06\u4e0d\u56fa\u5b9a</h>\u3002\u8bf7\u6ce8\u610f\uff0c\u60a8\u81ea\u5df1\u7684\u7684\u50a8\u84c4\u989d\u5ea6\u5728\u6bcf\u6b21\u9009\u62e9\u65f6\u4f1a\u53d7\u5230 <h>20 \u5143\u7684\u9650\u5236</h>\u3002</p>\n        </div>\n        ',choices:["\u7ee7\u7eed"]},chart_deposit_procedure2]},chart_deposit_procedure_timeline3={timeline:[{type:jsPsychHtmlButtonResponse,stimulus:()=>'\n        <div class="form-container">\n        <p>\u5728\u63a5\u4e0b\u6765\u7684\u8bd5\u6b21\u4e2d\uff0c\u60a8\u5c06\u770b\u5230\u4e0d\u540c\u7684\u50a8\u84c4\u5b89\u6392\u3002\u4e0e\u4e4b\u524d\u7684\u89c4\u5219\u4e0d\u540c\uff0c\u60a8\u6536\u5230\u7684\u50a8\u84c4\u91d1\u989d\u7684<h>\u603b\u548c\u5c06\u4e0d\u56fa\u5b9a</h>\u3002\u8bf7\u6ce8\u610f\uff0c\u60a8\u81ea\u5df1\u7684\u7684\u50a8\u84c4\u989d\u5ea6\u5728\u6bcf\u6b21\u9009\u62e9\u65f6\u4f1a\u53d7\u5230 <h>60 \u5143\u7684\u9650\u5236</h>\u3002</p>\n        </div>\n        ',choices:["\u7ee7\u7eed"]},chart_deposit_procedure3]},chart_donation_procedure_timeline3={timeline:[{type:jsPsychHtmlButtonResponse,stimulus:()=>'\n        <div class="form-container">\n        <p>\u5728\u63a5\u4e0b\u6765\u7684\u8bd5\u6b21\u4e2d\uff0c\u60a8\u5c06\u770b\u5230\u4e0d\u540c\u7684\u6350\u8d60\u5b89\u6392\u3002\u4e0e\u4e4b\u524d\u7684\u89c4\u5219\u4e0d\u540c\uff0c\u60a8\u548c\u5bf9\u5e94\u7684\u5b9e\u9a8c\u8005\u7684\u6350\u8d60<h>\u603b\u548c\u5c06\u4e0d\u56fa\u5b9a</h>\u3002\u8bf7\u6ce8\u610f\uff0c\u60a8\u7684\u6350\u8d60\u989d\u5ea6\u5728\u6bcf\u6b21\u9009\u62e9\u65f6\u4f1a\u53d7\u5230 <h>60 \u5143\u7684\u9650\u5236</h>\u3002</p>\n        </div>\n        ',choices:["\u7ee7\u7eed"]},chart_donation_procedure3]};main_timeline.push(part3_tutorial,part3_deposit,reset_variables,chart_deposit_procedure_timeline1,reset_variables,chart_deposit_procedure_timeline2,reset_variables,chart_deposit_procedure_timeline3,part3_donation,reset_variables,chart_donation_procedure_timeline1,reset_variables,chart_donation_procedure_timeline2,reset_variables,chart_donation_procedure_timeline3);const end={type:jsPsychHtmlKeyboardResponse,stimulus:()=>{let e="<p>\u5b9e\u9a8c\u7ed3\u675f\uff0c\u611f\u8c22\u60a8\u7684\u53c2\u4e0e\uff01</p>"
;return e+="<p>Experiment is over. Thank you for your participation!</p>"},trial_duration:4e3,choices:" ",extensions:[{type:Naodao}],response_end_trial:!0};main_timeline.push(end),jsPsych.run(main_timeline);